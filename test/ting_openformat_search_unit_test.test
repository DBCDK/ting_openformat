<?php

/**
 * Test class for ting_openformat
 */
class TingOpenFormatSearchUnitTestCase extends DrupalUnitTestCase {
  /**
   * @return array
   */
  public static function getInfo() {
    return array(
      'name' => t('Ting OpenFormat Search and View Unittest'),
      'description' => t('Tests various methods for search and view'),
      'group' => t('Ting Openformat'),
    );
  }

  public function setUp() {
    module_load_include('inc', 'ting_openformat', 'ting_openformat.search');
    module_load_include('php', 'ting_client', 'lib/result/object/TingClientObjectCollection');
    parent::setUp();
  }

  public function test_ting_openformat_add_relations_to_element() {

    // Relations are added if they exist
    $element = new stdClass();
    $tingClientObject = new stdClass();
    $tingClientObject->relationsData = 'relationData';
    $tingClientObjectCollection = new TingClientObjectCollection(array($tingClientObject));

    _ting_openformat_add_relations_to_element($element, $tingClientObjectCollection);

    $expected_relations = 'relationData';
    $this->assertEqual($element->relationsData, $expected_relations, 'Relations are set');

    // No Relations are added if they do not exist
    $element = new stdClass();
    $tingClientObjectNoRelationData = new stdClass();
    $tingClientObjectCollection = new TingClientObjectCollection(array($tingClientObjectNoRelationData));

    _ting_openformat_add_relations_to_element($element, $tingClientObjectCollection);

    $this->assertFalse(isset($element->relationsData), 'Relations are not set');
  }
}
